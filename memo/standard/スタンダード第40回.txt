例外処理

StudentManagement03の直下にexceptionパッケージ。その中にTestExceptionクラス作成
※Test後消してよい

// TestException
package training.StudentManagement03.exception;

public class TestException extends Exception{

}

extends Exception
・例外クラス作成に必要


生成　→　メソッドのオーバーライド　→　Java.lang.Exceptionすべて選択
public TestException() {
    super();
  }

  public TestException(String message) {
    super(message);
  }

  public TestException(String message, Throwable cause) {
    super(message, cause);
  }

  public TestException(Throwable cause) {
    super(cause);
  }


@ExceptionHandler
例外をキャッチして処理する


Exception : エラーそのもの
ExceptionHandler : エラーの処理


// StudentController

/**
   * 受講生詳細の一覧検索です。
   * 全件検索を行うので、条件指定は行わない。
   *
   * @return 受講生詳細一覧(全件)
   */
  @GetMapping("/studentList")
  public List<StudentDetail> getStudentsList() throws TestException {
    throw new TestException("エラーが発生しました。");
  }

意図的に例外を発生させる。


例外処理を行うクラス
// GlobalExceptionHandler

package training.StudentManagement03.exception;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;

@ControllerAdvice
public class GlobalExceptionHandler {

  @ExceptionHandler(TestException.class)
  public ResponseEntity<String> handleTestException(TestException ex) {
    return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(ex.getMessage());
  }
}

@ExceptionHandlerはStudentController.javaから移動させた


※最後に例外を発生させたメソッドを元に戻しておく
@GetMapping("/studentList")
  public List<StudentDetail> getStudentsList() {
    return service.searchStudentsList();
  }